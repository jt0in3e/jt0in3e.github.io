<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Включаємо PhotoPrism за стіною NGINX і в суб-директорії (папці) - Технічно технічний блог</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta itemprop=name content="Включаємо PhotoPrism за стіною NGINX і в суб-директорії (папці)"><meta itemprop=description content="PhotoPrism - чудова веб програма для організації, сортування, класифікації фото; Nginx - усі знають цей веб сервер, веб проксі і ще багато чого веб.
До недавнього часу PhotoPrism складно налаштовувався в контексті роботи за стіною, тобто за надійним веб проксі сервером в контексті доступу із суб-директорії, наприклад, https://example.com/photoprism. З останніми оновленнями усе запрацювало. Внизу інфо й налаштування як цього досягнути. Налаштування зроблені завдяки:
пану @scolby33, який підняв питання про запуск такої схеми; опису, зазначеному в документації PhotoPrism Черговість налаштування не має значення."><meta itemprop=datePublished content="2022-05-09T21:34:53+02:00"><meta itemprop=dateModified content="2024-08-16T14:07:01+02:00"><meta itemprop=wordCount content="1378"><meta itemprop=keywords content="General,Server,Web,Webserver,Configs,Setup,Linux,Nginx,Photoprism"><meta property="og:url" content="https://jt0in3e.github.io/2022/05/%D0%B2%D0%BA%D0%BB%D1%8E%D1%87%D0%B0%D1%94%D0%BC%D0%BE-photoprism-%D0%B7%D0%B0-%D1%81%D1%82%D1%96%D0%BD%D0%BE%D1%8E-nginx-%D1%96-%D0%B2-%D1%81%D1%83%D0%B1-%D0%B4%D0%B8%D1%80%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D1%96%D1%97-%D0%BF%D0%B0%D0%BF%D1%86%D1%96/"><meta property="og:site_name" content="Технічно технічний блог"><meta property="og:title" content="Включаємо PhotoPrism за стіною NGINX і в суб-директорії (папці)"><meta property="og:description" content="PhotoPrism - чудова веб програма для організації, сортування, класифікації фото; Nginx - усі знають цей веб сервер, веб проксі і ще багато чого веб.
До недавнього часу PhotoPrism складно налаштовувався в контексті роботи за стіною, тобто за надійним веб проксі сервером в контексті доступу із суб-директорії, наприклад, https://example.com/photoprism. З останніми оновленнями усе запрацювало. Внизу інфо й налаштування як цього досягнути. Налаштування зроблені завдяки:
пану @scolby33, який підняв питання про запуск такої схеми; опису, зазначеному в документації PhotoPrism Черговість налаштування не має значення."><meta property="og:locale" content="uk"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-09T21:34:53+02:00"><meta property="article:modified_time" content="2024-08-16T14:07:01+02:00"><meta property="article:tag" content="General"><meta property="article:tag" content="Server"><meta property="article:tag" content="Web"><meta property="article:tag" content="Webserver"><meta property="article:tag" content="Configs"><meta property="article:tag" content="Setup"><meta name=twitter:card content="summary"><meta name=twitter:title content="Включаємо PhotoPrism за стіною NGINX і в суб-директорії (папці)"><meta name=twitter:description content="PhotoPrism - чудова веб програма для організації, сортування, класифікації фото; Nginx - усі знають цей веб сервер, веб проксі і ще багато чого веб.
До недавнього часу PhotoPrism складно налаштовувався в контексті роботи за стіною, тобто за надійним веб проксі сервером в контексті доступу із суб-директорії, наприклад, https://example.com/photoprism. З останніми оновленнями усе запрацювало. Внизу інфо й налаштування як цього досягнути. Налаштування зроблені завдяки:
пану @scolby33, який підняв питання про запуск такої схеми; опису, зазначеному в документації PhotoPrism Черговість налаштування не має значення."><link rel=stylesheet type=text/css media=screen href=https://jt0in3e.github.io/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://jt0in3e.github.io/css/main.css><link id=dark-scheme rel=stylesheet type=text/css href=https://jt0in3e.github.io/css/dark.css><script src=https://jt0in3e.github.io/js/feather.min.js></script><script src=https://jt0in3e.github.io/js/main.js></script></head><body><div class="container wrapper"><div class=header><h1 class=site-title><a href=https://jt0in3e.github.io/>Технічно технічний блог</a></h1><div class=site-description><p>Деякі експеременти, щось з програмування, щось із пізнання та дійсност</p><nav class="nav social"><ul class=flat><li><a href=https://github.com/jt0in3e title=Github><i data-feather=github></i></a></li><li><a href=/index.xml title=RSS><i data-feather=rss></i></a></li></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>Берлога</a></li><li><a href=/posts>Усі нариси</a></li><li><a href=/about>About</a></li><li><a href=/tags>Tags</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>09</span>
<span class=rest>May 2022</span></div></div><div class=matter><h1 class=title>Включаємо PhotoPrism за стіною NGINX і в суб-директорії (папці)</h1></div></div><aside class=toc><header><h2>Contents</h2></header><nav id=TableOfContents><ol><li><ol><li></li></ol></li></ol></nav></aside><div class=markdown><div class=date><span><b>published:</b> <u>May 9, 2022</u>, <b><i>updated:</i></b> <i>August 16, 2024; 14:07</i></span></div><p><a href=https://docs.photoprism.app/>PhotoPrism</a> - чудова веб програма для організації, сортування, класифікації фото; <a href=https://nginx.org/>Nginx</a> - усі знають цей веб сервер, веб проксі і ще багато чого веб.</p><p>До недавнього часу PhotoPrism складно налаштовувався в контексті роботи за стіною, тобто за надійним веб проксі сервером в контексті доступу із суб-директорії, наприклад, <code>https://example.com/photoprism</code>. З останніми оновленнями усе запрацювало. Внизу інфо й налаштування як цього досягнути. Налаштування зроблені завдяки:</p><ul><li>пану <a href=https://github.com/photoprism/photoprism/issues/939#issue-790683829>@scolby33</a>, який підняв питання про запуск такої схеми;</li><li><a href=https://docs.photoprism.app/getting-started/advanced/nginx-proxy-setup/>опису, зазначеному в документації PhotoPrism</a></li></ul><p>Черговість налаштування не має значення.</p><h4 id=nginx>Nginx</h4><p>Налаштування основного домену <code>example.com</code> (<em>example.com.conf</em>) уже є, доналаштовуємо лише <em>суб директорію</em> <code>/photoprism</code>.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span>    <span style=color:#6272a4>#include photoprism&#39;s configurations
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#ff79c6>location</span> <span style=color:#f1fa8c>/photoprism/</span> {
</span></span><span style=display:flex><span>        <span style=color:#6272a4># - - - - - - - - -
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        <span style=color:#6272a4># Reverse Proxy
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        <span style=color:#6272a4># - - - - - - - - -
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        <span style=color:#ff79c6>client_max_body_size</span> <span style=color:#f1fa8c>500M</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>proxy_redirect</span>    off;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>proxy_set_header</span>  <span style=color:#f1fa8c>X-Real-IP</span> <span style=color:#8be9fd;font-style:italic>$remote_addr</span>;                        <span style=color:#6272a4># Let PP know the clients real IP
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        <span style=color:#ff79c6>proxy_set_header</span> <span style=color:#f1fa8c>X-Forwarded-For</span> <span style=color:#8be9fd;font-style:italic>$proxy_add_x_forwarded_for</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>proxy_set_header</span> <span style=color:#f1fa8c>Host</span> <span style=color:#8be9fd;font-style:italic>$http_host</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>proxy_pass</span> <span style=color:#f1fa8c>http://127.0.0.1:8484</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>proxy_buffering</span> off;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>proxy_http_version</span> <span style=color:#bd93f9>1</span><span style=color:#f1fa8c>.1</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>proxy_set_header</span> <span style=color:#f1fa8c>Upgrade</span> <span style=color:#8be9fd;font-style:italic>$http_upgrade</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>proxy_set_header</span> <span style=color:#f1fa8c>Connection</span> <span style=color:#f1fa8c>&#34;upgrade&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>proxy_set_header</span> <span style=color:#f1fa8c>X-Forwarded-Proto</span> <span style=color:#8be9fd;font-style:italic>$scheme</span>;                             <span style=color:#6272a4># Let PP know that this connection used HTTP or HTTPS
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Важливо!</strong>: в директиві <code>location /photoprism/</code> вказати слеш в кінці (<strong>trailing slash</strong>).</p><p>В <code>proxy_pass</code> змінено порт на <strong>8484</strong> через зміну цього порта в налаштуваннях <em>Photoprism</em> (див.нижче)</p><h4 id=photoprism-configs>Photoprism configs</h4><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>version: <span style=color:#f1fa8c>&#39;3.5&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Example Docker Compose config file for PhotoPrism (Linux / AMD64)</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Note:</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># - Running PhotoPrism on a server with less than 4 GB of swap space or setting a memory/swap limit can cause unexpected</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#   restarts (&#34;crashes&#34;), for example, when the indexer temporarily needs more memory to process large files.</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># - If you install PhotoPrism on a public server outside your home network, please always run it behind a secure</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#   HTTPS reverse proxy such as Traefik or Caddy. Your files and passwords will otherwise be transmitted</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#   in clear text and can be intercepted by anyone, including your provider, hackers, and governments:</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#   https://docs.photoprism.app/getting-started/proxies/traefik/</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Documentation : https://docs.photoprism.app/getting-started/docker-compose/</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Docker Hub URL: https://hub.docker.com/r/photoprism/photoprism/</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># DOCKER COMPOSE COMMAND REFERENCE</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># see https://docs.photoprism.app/getting-started/docker-compose/#command-line-interface</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># --------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Start    | docker-compose up -d</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Stop     | docker-compose stop</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Update   | docker-compose pull</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Logs     | docker-compose logs --tail=25 -f</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Terminal | docker-compose exec photoprism bash</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Help     | docker-compose exec photoprism photoprism help</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Config   | docker-compose exec photoprism photoprism config</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Reset    | docker-compose exec photoprism photoprism reset</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Backup   | docker-compose exec photoprism photoprism backup -a -i</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Restore  | docker-compose exec photoprism photoprism restore -a -i</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Index    | docker-compose exec photoprism photoprism index</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Reindex  | docker-compose exec photoprism photoprism index -f</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Import   | docker-compose exec photoprism photoprism import</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># To search originals for faces without a complete rescan:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># docker-compose exec photoprism photoprism faces index</span>
</span></span><span style=display:flex><span><span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># All commands may have to be prefixed with &#34;sudo&#34; when not running as root.</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># This will point the home directory shortcut ~ to /root in volume mounts.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>services:
</span></span><span style=display:flex><span>  photoprism:
</span></span><span style=display:flex><span>    <span style=color:#6272a4>## Use photoprism/photoprism:preview for testing preview builds:</span>
</span></span><span style=display:flex><span>    image: photoprism/photoprism:latest
</span></span><span style=display:flex><span>    depends_on:
</span></span><span style=display:flex><span>      - mariadb
</span></span><span style=display:flex><span>    <span style=color:#6272a4>## Don&#39;t enable automatic restarts until PhotoPrism has been properly configured and tested!</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>## If the service gets stuck in a restart loop, this points to a memory, filesystem, network, or database issue:</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>## https://docs.photoprism.app/getting-started/troubleshooting/#fatal-server-errors</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4># restart: unless-stopped</span>
</span></span><span style=display:flex><span>    security_opt:
</span></span><span style=display:flex><span>      - seccomp:unconfined
</span></span><span style=display:flex><span>      - apparmor:unconfined
</span></span><span style=display:flex><span>    ports:
</span></span><span style=display:flex><span>      - <span style=color:#f1fa8c>&#34;8484:2342&#34;</span> <span style=color:#6272a4># HTTP port (host:container)</span>
</span></span><span style=display:flex><span>    environment:
</span></span><span style=display:flex><span>      PHOTOPRISM_ADMIN_PASSWORD: <span style=color:#f1fa8c>&#34;insecure&#34;</span>          <span style=color:#6272a4># !!! PLEASE CHANGE YOUR INITIAL &#34;admin&#34; PASSWORD !!!</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_SITE_URL: <span style=color:#f1fa8c>&#34;https://example.com/photoprism/&#34;</span>  <span style=color:#6272a4># public server URL incl http:// or https:// and /path, :port is optional</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_ORIGINALS_LIMIT: <span style=color:#bd93f9>5000</span>               <span style=color:#6272a4># file size limit for originals in MB (increase for high-res video)</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_HTTP_COMPRESSION: <span style=color:#f1fa8c>&#34;gzip&#34;</span>            <span style=color:#6272a4># improves transfer speed and bandwidth utilization (none or gzip)</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DEBUG: <span style=color:#f1fa8c>&#34;false&#34;</span>                      <span style=color:#6272a4># run in debug mode (shows additional log messages)</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_PUBLIC: <span style=color:#f1fa8c>&#34;false&#34;</span>                     <span style=color:#6272a4># no authentication required (disables password protection)</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_READONLY: <span style=color:#f1fa8c>&#34;false&#34;</span>                   <span style=color:#6272a4># don&#39;t modify originals directory (reduced functionality)</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_EXPERIMENTAL: <span style=color:#f1fa8c>&#34;false&#34;</span>               <span style=color:#6272a4># enables experimental features</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DISABLE_CHOWN: <span style=color:#f1fa8c>&#34;false&#34;</span>              <span style=color:#6272a4># disables storage permission updates on startup</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DISABLE_WEBDAV: <span style=color:#f1fa8c>&#34;false&#34;</span>             <span style=color:#6272a4># disables built-in WebDAV server</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DISABLE_SETTINGS: <span style=color:#f1fa8c>&#34;false&#34;</span>           <span style=color:#6272a4># disables Settings in Web UI</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DISABLE_TENSORFLOW: <span style=color:#f1fa8c>&#34;false&#34;</span>         <span style=color:#6272a4># disables all features depending on TensorFlow</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DISABLE_FACES: <span style=color:#f1fa8c>&#34;false&#34;</span>              <span style=color:#6272a4># disables facial recognition</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DISABLE_CLASSIFICATION: <span style=color:#f1fa8c>&#34;false&#34;</span>     <span style=color:#6272a4># disables image classification</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DARKTABLE_PRESETS: <span style=color:#f1fa8c>&#34;false&#34;</span>          <span style=color:#6272a4># enables Darktable presets and disables concurrent RAW conversion</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DETECT_NSFW: <span style=color:#f1fa8c>&#34;false&#34;</span>                <span style=color:#6272a4># flag photos as private that MAY be offensive (requires TensorFlow)</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_UPLOAD_NSFW: <span style=color:#f1fa8c>&#34;true&#34;</span>                 <span style=color:#6272a4># allows uploads that MAY be offensive</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4># PHOTOPRISM_DATABASE_DRIVER: &#34;sqlite&#34;         # SQLite is an embedded database that doesn&#39;t require a server</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DATABASE_DRIVER: <span style=color:#f1fa8c>&#34;mysql&#34;</span>            <span style=color:#6272a4># use MariaDB 10.5+ or MySQL 8+ instead of SQLite for improved performance</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DATABASE_SERVER: <span style=color:#f1fa8c>&#34;mariadb:3306&#34;</span>     <span style=color:#6272a4># MariaDB or MySQL database server (hostname:port)</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DATABASE_NAME: <span style=color:#f1fa8c>&#34;photoprism&#34;</span>         <span style=color:#6272a4># MariaDB or MySQL database schema name</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DATABASE_USER: <span style=color:#f1fa8c>&#34;photoprism&#34;</span>         <span style=color:#6272a4># MariaDB or MySQL database user name</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_DATABASE_PASSWORD: <span style=color:#f1fa8c>&#34;insecure&#34;</span>       <span style=color:#6272a4># MariaDB or MySQL database user password</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_SITE_TITLE: <span style=color:#f1fa8c>&#34;PhotoPrism&#34;</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_SITE_CAPTION: <span style=color:#f1fa8c>&#34;AI-Powered Photos App&#34;</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_SITE_DESCRIPTION: <span style=color:#f1fa8c>&#34;&#34;</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_SITE_AUTHOR: <span style=color:#f1fa8c>&#34;&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4>## Run/install on first startup (options: update, gpu, tensorflow, davfs, nano, clean):</span>
</span></span><span style=display:flex><span>      PHOTOPRISM_INIT: <span style=color:#f1fa8c>&#34;gpu tensorflow&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4>## Hardware video transcoding config (optional)</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4># PHOTOPRISM_FFMPEG_BUFFERS: &#34;64&#34;              # FFmpeg capture buffers (default: 32)</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4># PHOTOPRISM_FFMPEG_BITRATE: &#34;32&#34;              # FFmpeg encoding bitrate limit in Mbit/s (default: 50)</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4># PHOTOPRISM_FFMPEG_ENCODER: &#34;h264_v4l2m2m&#34;    # use Video4Linux for AVC transcoding (default: libx264)</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4># PHOTOPRISM_FFMPEG_ENCODER: &#34;h264_qsv&#34;        # use Intel Quick Sync Video for AVC transcoding (default: libx264)</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4>## Run as a specific user, group, or with a custom umask (does not work together with &#34;user:&#34;)</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4># PHOTOPRISM_UID: 1000</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4># PHOTOPRISM_GID: 1000</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4># PHOTOPRISM_UMASK: 0000</span>
</span></span><span style=display:flex><span>      HOME: <span style=color:#f1fa8c>&#34;/photoprism&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>## Start as a non-root user (see https://docs.docker.com/engine/reference/run/#user)</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4># user: &#34;1000:1000&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>## Share hardware devices with FFmpeg and TensorFlow (optional):</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4># devices:</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>#  - &#34;/dev/dri:/dev/dri&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>#  - &#34;/dev/nvidia0:/dev/nvidia0&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>#  - &#34;/dev/nvidiactl:/dev/nvidiactl&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>#  - &#34;/dev/video11:/dev/video11&#34; # Video4Linux (h264_v4l2m2m)</span>
</span></span><span style=display:flex><span>    working_dir: <span style=color:#f1fa8c>&#34;/photoprism&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>## Storage Folders: &#34;~&#34; is a shortcut for your home directory, &#34;.&#34; for the current directory</span>
</span></span><span style=display:flex><span>    volumes:
</span></span><span style=display:flex><span>      <span style=color:#6272a4># &#34;/host/folder:/photoprism/folder&#34;                # example</span>
</span></span><span style=display:flex><span>      - <span style=color:#f1fa8c>&#34;~/Pictures:/photoprism/originals&#34;</span>               <span style=color:#6272a4># original media files (photos and videos)</span>
</span></span><span style=display:flex><span>      <span style=color:#6272a4># - &#34;/example/family:/photoprism/originals/family&#34; # *additional* media folders can be mounted like this</span>
</span></span><span style=display:flex><span>      - <span style=color:#f1fa8c>&#34;~/Import:/photoprism/import&#34;</span>                  <span style=color:#6272a4># *optional* base folder from which files can be imported to originals</span>
</span></span><span style=display:flex><span>      - <span style=color:#f1fa8c>&#34;./storage:/photoprism/storage&#34;</span>                  <span style=color:#6272a4># *writable* storage folder for cache, database, and sidecar files (never remove)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>## Database Server (recommended)</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>## see https://docs.photoprism.app/getting-started/faq/#should-i-use-sqlite-mariadb-or-mysql</span>
</span></span><span style=display:flex><span>  mariadb:
</span></span><span style=display:flex><span>    <span style=color:#6272a4>## If MariaDB gets stuck in a restart loop, this points to a memory or filesystem issue:</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>## https://docs.photoprism.app/getting-started/troubleshooting/#fatal-server-errors</span>
</span></span><span style=display:flex><span>    restart: unless-stopped
</span></span><span style=display:flex><span>    image: mariadb:10.6
</span></span><span style=display:flex><span>    security_opt:
</span></span><span style=display:flex><span>      - seccomp:unconfined
</span></span><span style=display:flex><span>      - apparmor:unconfined
</span></span><span style=display:flex><span>    command: mysqld --innodb-buffer-pool-size<span style=color:#ff79c6>=</span>128M --transaction-isolation<span style=color:#ff79c6>=</span>READ-COMMITTED --character-set-server<span style=color:#ff79c6>=</span>utf8mb4 --collation-server<span style=color:#ff79c6>=</span>utf8mb4_unicode_ci --max-connections<span style=color:#ff79c6>=</span><span style=color:#bd93f9>512</span> --innodb-rollback-on-timeout<span style=color:#ff79c6>=</span>OFF --innodb-lock-wait-timeout<span style=color:#ff79c6>=</span><span style=color:#bd93f9>120</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>## Never store database files on an unreliable device such as a USB flash drive, an SD card, or a shared network folder:</span>
</span></span><span style=display:flex><span>    volumes:
</span></span><span style=display:flex><span>      - <span style=color:#f1fa8c>&#34;./database:/var/lib/mysql&#34;</span> <span style=color:#6272a4># important, don&#39;t remove</span>
</span></span><span style=display:flex><span>    environment:
</span></span><span style=display:flex><span>      MYSQL_ROOT_PASSWORD: insecure
</span></span><span style=display:flex><span>      MYSQL_DATABASE: photoprism
</span></span><span style=display:flex><span>      MYSQL_USER: photoprism
</span></span><span style=display:flex><span>      MYSQL_PASSWORD: insecure
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>## Watchtower upgrades services automatically (optional)</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>## see https://docs.photoprism.app/getting-started/updates/#watchtower</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>#</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4># watchtower:</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>#   restart: unless-stopped</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>#   image: containrrr/watchtower</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>#   environment:</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>#     WATCHTOWER_CLEANUP: &#34;true&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>#     WATCHTOWER_POLL_INTERVAL: 7200 # checks for updates every two hours</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>#   volumes:</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>#     - &#34;/var/run/docker.sock:/var/run/docker.sock&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>#     - &#34;~/.docker/config.json:/config.json&#34; # optional, for authentication if you have a Docker Hub account</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Важливо!</strong>, це</p><blockquote><p>порт хосту змінено на 8484 в порівняні із налаштуваннями по замовчуванню. Порт можна не змінювати, це за бажанням. Зміну здійснено аби відповідати конфігурації Nginx -></p></blockquote><pre tabindex=0><code>    ports:
      - &#34;**8484**:2342&#34; # HTTP port (host:container)
</code></pre><blockquote><p>змінити основний пароль -></p></blockquote><pre tabindex=0><code>      PHOTOPRISM_ADMIN_PASSWORD: &#34;insecure&#34;          # !!! PLEASE CHANGE YOUR INITIAL &#34;admin&#34; PASSWORD !!!
</code></pre><blockquote><p>повністю прописати адресу (шлях) до суб директорії, включаючи домен та слеш в кінці шляху -></p></blockquote><pre tabindex=0><code>      PHOTOPRISM_SITE_URL: &#34;https://example.com/photoprism/&#34;  # public server URL incl http:// or https:// and /path, :port is optional
</code></pre><blockquote><p>додатково включено це налаштування, аби гарно впізнавались обличчя -></p></blockquote><pre tabindex=0><code>      PHOTOPRISM_INIT: &#34;gpu tensorflow&#34;
</code></pre><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script><link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><div id=comment-section></div><script>initComments({node:document.getElementById("comment-section"),defaultHomeserverUrl:"https://matrix.cactus.chat:8448",serverName:"cactus.chat",siteName:"jt0in3e",commentSectionId:"post-11-photoprism-nginx",updateInterval:180})</script></div><div class=tags><ul class=flat><li class=tag-li><a href=/tags/general>general</a></li><li class=tag-li><a href=/tags/server>server</a></li><li class=tag-li><a href=/tags/web>web</a></li><li class=tag-li><a href=/tags/webserver>webserver</a></li><li class=tag-li><a href=/tags/configs>configs</a></li><li class=tag-li><a href=/tags/setup>setup</a></li><li class=tag-li><a href=/tags/linux>linux</a></li><li class=tag-li><a href=/tags/nginx>nginx</a></li><li class=tag-li><a href=/tags/photoprism>photoprism</a></li></ul></div><div class=back><a href=https://github.com/jt0in3e/jt0in3e.github.io/blob/master/content/posts/post-10/index.md title=github><i data-feather=github></i> Edit this on GitHub</a></div><div class=back><a href=https://jt0in3e.github.io/><span aria-hidden=true>← Back</span></a></div><div class=back>Next time, we'll talk about <i>"10 Reasons why gcc SHOULD be re-written in JavaScript - You won't believe #8!"</i></div></div></div><div class="footer wrapper"><nav class=nav><div>2022 © J:a.k.a:Y</nav></div><script>feather.replace()</script></body></html>